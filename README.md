# Rolemapping

Rolemapping is web app to store, parse, and format Active Directory data.

It was built, in part, due to the limitations of Excel and multiple weeks that I would have spent consolidating Active Directory user data manually. It was also the perfect introduction to databases, reading CSV files, and [Bootstrap](https://github.com/twbs/bootstrap); all within [the Rails framework](https://github.com/rails/rails).

## Getting Started

Ruby version: 2.3.0
Rails version: 5.0.2

1. [Download the repository](https://github.com/tlapinsk/rolemapping/archive/master.zip) OR

		$ git clone https://github.com/tlapinsk/rolemapping

2. At the command prompt

		$ cd rolemapping
		$ rails s

3. Using a browser, go to http://localhost:3000 and you'll see the application homepage.

4. Edit the application to your liking. You may find the following resources handy:
	* [AXLSX](https://github.com/randym/axlsx)
	* [FFaker](https://github.com/ffaker/ffaker)
	* [Bootstrap](https://github.com/twbs/bootstrap)

5. Visit [Configuration](#configuration) for more detailed instructions.

### System Dependencies

See [Gemfile](https://github.com/tlapinsk/rolemapping/blob/master/Gemfile) and [Gemfile.lock](https://github.com/tlapinsk/rolemapping/blob/master/Gemfile.lock).

_Note: I did not test the application on Windows and I run the following system_

Macbook Pro (15-inch, Mid 2010)
macOS Sierra | Version 10.12.4
Memory: 8gb
Storage: 500gb Samsung SSD

## Configuration

This section provides more detailed instructions for the application, including customization.

### Customizing 'Create Test Data' Output

**Adding additional job titles and groups:**
Feel free to add additional job titles in the `high_ranking`, `low_ranking`, and `group` arrays.

There are currently 13 high ranking titles, so keep that in mind when editing the `high_ranking` array. 

**Editing CSV file name:**
Change the `file` variable with whatever you feel is appropriate. Note: Don't forget to edit the `date` variable.

**Total rows output**
By default there are 1500 total rows in the CSV. The first 13 are high ranking (CEO, CIO, etc.), while the remaining 1487 are low ranking (Business Analyst, Product Manager, etc.). 

Edit the total number of officers by changing the `high_ranking` or `low_ranking` array. OR by changing the `1487.times do` loop.

**Adding additional columns**

1. Start by changing the `header` array. Add the additional column headers that you prefer.

2. Within the two loops, make sure you add the appropriate variable to match the column header.

3. Edit `csv << [name, h, email, shoretel, cell, fax, memberof]` to include your newly created variables.

4. BAM! You should have a new columns added to your Test Data CSV.

_Note: Check out [the FFaker documentation](https://github.com/ffaker/ffaker) to see what other data can be generated by the FFaker gem._

### Customizing 'Import' Function

Provides instructions for customizing the `Import Active Directory CSV File` functionality.

_Note: You might want to edit the Create CSV section before customizing the 'Import' function.

**Editing the database**
Depending on your goals for updating this part of the application, you will need to do some thinking through the database schema and necessary migrations you'll be making.

I'll help run through an example migration that you can run below:

1. Navigate to `schema.rb` and look at the User table columns
2. Decide on the extra columns you want to add and/or delete
3. Open Terminal and run `rails generate migration add_fieldname_to_tablename`
4. Add the additional column names and types to the migration file (code example below)

		class Lastname < ActiveRecord::Migration[5.0]
		  def change
		  	change_table :users do |t|
		  		t.column :laptop, :string
		  		t.column :desktop, :string
		  		t.column :monitor, :string
		  	end
		  end
		end

5. Run `rake db:migrate` to migrate the changes
6. Check `schema.rb` to ensure the right changes were made

Next, you'll have to edit `welcome_controller.rb`

1. Open up `welcome_controller.rb`
2. Navigate to the `ad_upload(file)` function
3. Go to the following code

		user.title = row['Job']
    user.email = row['Email']
    user.shoretel = row['ShoreTel']
    user.cell = row['Cell']
    user.fax = row['Fax']
    user.group = row['MemberOf']
    user.job_id = job.id if !job.nil?
    user.save!
    puts "#{user.name} saved"

4. Create new `user.NEWCOLUMN = row['NEWCOLUMN']

		user.title = row['Job']
    user.email = row['Email']
    user.shoretel = row['ShoreTel']
    user.cell = row['Cell']
    user.fax = row['Fax']
    user.group = row['MemberOf']
		user.laptop = row['Laptop']
    user.desktop = row['Desktop']
    user.monitor = row['Monitor']
    user.job_id = job.id if !job.nil?
    user.save!
    puts "#{user.name} saved"

5. Save your project, reboot the app, and load http://localhost:3000
6. Import your new CSV and debug as necessary
7. BOOM! You've successfully edited the database schema










This README would normally document whatever steps are necessary to get the
application up and running.

Things you may want to cover:

* Ruby version

* System dependencies

* Configuration

* Database creation

* Database initialization

* How to run the test suite

* Services (job queues, cache servers, search engines, etc.)

* Deployment instructions

* ...
